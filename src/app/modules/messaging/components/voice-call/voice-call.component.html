<p-dialog
    [visible]="callStatus.status === 'incoming'"
    [modal]="true"
    [closable]="false"
    [draggable]="false"
    styleClass="voice-call-dialog glass-effect"
    [style]="{width: '90vw', maxWidth: '360px'}"
    header="">
    <div class="call-dialog">
        <div class="call-status" [class.incoming]="callStatus.status === 'incoming'">
            <div class="avatar-container">
                <div class="avatar-wrapper">
                    <div class="ripple"></div>
                    <div class="ripple delay-1"></div>
                    <div class="ripple delay-2"></div>
                    <div class="avatar">
                        <img [src]="callStatus.photoUrl" class="rounded-full">
                    </div>
                </div>
                <div class="caller-info">
                    <h3 class="caller-name">{{ callStatus.callerName }}</h3>
                    <p class="call-type">
                        <i class="fas fa-phone-alt"></i>
                        <span>Incoming voice call</span>
                    </p>
                </div>
            </div>

            <div class="call-actions">
                <button pButton class="p-button-rounded p-button-success accept-btn"
                        (click)="acceptCall()">
                    <i class="fas fa-phone-alt"></i>
                </button>
                <button pButton class="p-button-rounded p-button-danger decline-btn"
                        (click)="rejectCall()">
                    <i class="fas fa-phone-slash"></i>
                </button>
            </div>
        </div>
    </div>
</p-dialog>

<p-dialog
    [visible]="callStatus.status === 'connected'"
    [modal]="true"
    [closable]="false"
    [draggable]="false"
    styleClass="voice-call-dialog glass-effect"
    [style]="{width: '90vw', maxWidth: '360px'}"
    header="">
    <div class="call-dialog active-call">
        <div class="call-status">
            <div class="avatar-container">
                <div class="avatar-wrapper active">
                    <div class="wave-effect"></div>
                    <div class="avatar">
                        <img [src]="callStatus.photoUrl" class="rounded-full">
                    </div>
                </div>
                <div class="caller-info">
                    <h3 class="caller-name">{{ callStatus.callerName || 'Unknown Caller' }}</h3>
                    <p class="call-duration">{{ callDuration$ | async }}</p>
                </div>
            </div>

            <div class="call-controls">
                <button class="control-btn" [class.active]="!isMuted" (click)="toggleMute()">
                    <i class="fas" [class.fa-microphone]="!isMuted" [class.fa-microphone-slash]="isMuted"></i>
                </button>
                <button class="control-btn end-call" (click)="endCall()">
                    <i class="fas fa-phone-slash"></i>
                </button>
                <button class="control-btn" [class.active]="!isSpeakerOff" (click)="toggleSpeaker()">
                    <i class="fas" [class.fa-volume-up]="!isSpeakerOff" [class.fa-volume-mute]="isSpeakerOff"></i>
                </button>
            </div>
        </div>
    </div>
</p-dialog>

<p-dialog
    [visible]="callStatus.status === 'calling'"
    [modal]="true"
    [closable]="false"
    [draggable]="false"
    styleClass="voice-call-dialog glass-effect"
    [style]="{width: '90vw', maxWidth: '360px'}"
    header="">
    <div class="call-dialog">
        <div class="call-status outgoing">
            <div class="avatar-container">
                <div class="avatar-wrapper">
                    <div class="ripple"></div>
                    <div class="ripple delay-1"></div>
                    <div class="ripple delay-2"></div>
                    <div class="avatar">
                        <img [src]="callStatus.receiverPhotoUrl" class="bg-cover rounded-full" >
                    </div>
                </div>
                <div class="caller-info">
                    <h3 class="caller-name">{{ callStatus.receiverName }}</h3>
                    <p class="call-type">
                        <i class="fas fa-phone-alt"></i>
                        <span>Calling...</span>
                    </p>
                </div>
            </div>

            <div class="call-actions">
                <button pButton class="p-button-rounded p-button-danger decline-btn"
                        (click)="endCall()">
                    <i class="fas fa-phone-slash"></i>
                </button>
            </div>
        </div>
    </div>
</p-dialog>
